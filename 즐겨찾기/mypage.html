<!--<!DOCTYPE html>-->
<!--<html lang="ko">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>마이페이지</title>-->
<!--    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">-->

<!--    <script>-->
<!--        document.addEventListener("DOMContentLoaded", function() {-->
<!--            fetch("/mypage")-->
<!--                .then(response => response.json())-->
<!--                .then(data => {-->
<!--                    if (data.success) {-->
<!--                        displayPosts(data.my_posts, data.liked_posts);-->
<!--                    } else {-->
<!--                        alert("데이터를 가져오는 데 실패했습니다.");-->
<!--                    }-->
<!--                });-->
<!--        });-->

<!--        function displayPosts(myPosts, likedPosts) {-->
<!--            const myPostsDiv = document.getElementById("my-posts");-->
<!--            myPosts.forEach(post => {-->
<!--                const postDiv = document.createElement("div");-->
<!--                postDiv.innerHTML = `<h3>${post.title}</h3> #<p>${post.content}</p>-->
<!--                    <button onclick="editPost(${post.post_id})">수정</button>-->
<!--                    <button onclick="deletePost(${post.post_id})">삭제</button>`;-->
<!--                myPostsDiv.appendChild(postDiv);-->
<!--            });-->

<!--            const likedPostsDiv = document.getElementById("liked-posts");-->
<!--            likedPosts.forEach(post => {-->
<!--                const postDiv = document.createElement("div");-->
<!--                postDiv.innerHTML = `<h3>${post.title}</h3> #<p>${post.content}</p>`;-->
<!--                likedPostsDiv.appendChild(postDiv);-->
<!--            });-->
<!--        }-->

<!--        function editPost(postId) {-->
<!--            const newTitle = prompt("새 제목:");-->
<!--            #const newContent = prompt("새 내용:");-->
<!--            fetch(`/edit_post/${postId}`, {-->
<!--                method: "POST",-->
<!--                headers: {-->
<!--                    "Content-Type": "application/json"-->
<!--                },-->
<!--                body: JSON.stringify({ title: newTitle })-->
<!--                #body: JSON.stringify({ title: newTitle, content: newContent })-->
<!--            }).then(response => response.json())-->
<!--              .then(data => {-->
<!--                  if (data.success) {-->
<!--                      location.reload();-->
<!--                  } else {-->
<!--                      alert("글 수정에 실패했습니다.");-->
<!--                  }-->
<!--              });-->
<!--        }-->

<!--        function deletePost(postId) {-->
<!--            fetch(`/delete_post/${postId}`, {-->
<!--                method: "POST"-->
<!--            }).then(response => response.json())-->
<!--              .then(data => {-->
<!--                  if (data.success) {-->
<!--                      location.reload();-->
<!--                  } else {-->
<!--                      alert("글 삭제에 실패했습니다.");-->
<!--                  }-->
<!--              });-->
<!--        }-->
<!--    </script>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>마이페이지</h1>-->
<!--    <div>-->
<!--        <h2>내가 작성한 글</h2>-->
<!--        <div id="my-posts"></div>-->
<!--    </div>-->
<!--    <div>-->
<!--        <h2>내가 좋아요 누른 글</h2>-->
<!--        <div id="liked-posts"></div>-->
<!--    </div>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>마이페이지</h1>
    <div>
        <h2>내가 작성한 글</h2>
        <div id="my-posts"></div>
    </div>
    <div>
        <h2>내가 좋아요 누른 글</h2>
        <div id="liked-posts"></div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch("/mypage")
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        displayPosts(data.my_posts, data.liked_posts);
                    } else {
                        alert("데이터를 가져오는 데 실패했습니다.");
                    }
                });
        });

        function displayPosts(myPosts, likedPosts) {
            const myPostsDiv = document.getElementById("my-posts");
            const likedPostsDiv = document.getElementById("liked-posts");

            myPosts.forEach(post => {
                const postDiv = document.createElement("div");
                postDiv.innerHTML = `
                    <div class="post">
                        <h3>${post.title}</h3>
                        <p>${post.location}, ${post.place}, ${post.main_dish}</p>
                        <button onclick="editPost(${post.post_id})">수정</button>
                        <button onclick="deletePost(${post.post_id})">삭제</button>
                    </div>`;
                myPostsDiv.appendChild(postDiv);
            });

            likedPosts.forEach(post => {
                const postDiv = document.createElement("div");
                postDiv.innerHTML = `
                    <div class="post">
                        <h3>${post.title}</h3>
                        <p>${post.location}, ${post.place}, ${post.main_dish}</p>
                    </div>`;
                likedPostsDiv.appendChild(postDiv);
            });
        }

        function editPost(postId) {
            const newTitle = prompt("새 제목:");
            if (newTitle !== null) {
                fetch(`/edit_post/${postId}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ title: newTitle })
                }).then(response => response.json())
                  .then(data => {
                      if (data.success) {
                          location.reload();
                      } else {
                          alert("글 수정에 실패했습니다.");
                      }
                  });
            }
        }

        function deletePost(postId) {
            if (confirm("정말로 삭제하시겠습니까?")) {
                fetch(`/delete_post/${postId}`, {
                    method: "POST"
                }).then(response => response.json())
                  .then(data => {
                      if (data.success) {
                          location.reload();
                      } else {
                          alert("글 삭제에 실패했습니다.");
                      }
                  });
            }
        }
    </script>
</body>
</html>
